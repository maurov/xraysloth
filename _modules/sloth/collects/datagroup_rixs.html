

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sloth.collects.datagroup_rixs &mdash; Sloth 0.3.0-dev documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Sloth
          

          
            
            <img src="../../../_static/xraysloth.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Full contents - hidden:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../todo.html">To Do</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Sloth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>sloth.collects.datagroup_rixs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sloth.collects.datagroup_rixs</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;DataGroupRixs: work with  RIXS data sets (2D maps)</span>
<span class="sd">=====================================================</span>

<span class="sd">.. note: RIXS stands for Resonant Inelastic X-ray Scattering</span>

<span class="sd">- DataGroup</span>
<span class="sd">  - DataGroup2D</span>
<span class="sd">    - DataGroupRixs</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">griddata</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">gridspec</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">MaxNLocator</span><span class="p">,</span> <span class="n">AutoLocator</span>

<span class="c1"># sloth</span>
<span class="kn">from</span> <span class="nn">.datagroup2D</span> <span class="k">import</span> <span class="n">DataGroup2D</span>
<span class="kn">from</span> <span class="nn">..math.gridxyz</span> <span class="k">import</span> <span class="n">gridxyz</span>
<span class="kn">from</span> <span class="nn">..io.specfile_reader</span> <span class="k">import</span> <span class="n">_mot2array</span>
<span class="kn">from</span> <span class="nn">..io.specfile_reader</span> <span class="k">import</span> <span class="n">SpecfileData</span>
<span class="kn">from</span> <span class="nn">sloth.fit.peakfit</span> <span class="k">import</span> <span class="n">fit_splitpvoigt</span>


<div class="viewcode-block" id="get_xyz_bm16"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.get_xyz_bm16">[docs]</a><span class="k">def</span> <span class="nf">get_xyz_bm16</span><span class="p">(</span><span class="n">logobj</span><span class="p">,</span> <span class="n">specobj</span><span class="p">,</span> <span class="n">fit_elastic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;function to get 3 arrays representing the RIXS plane</span>

<span class="sd">    .. note: this scheme is currently used at FAME-UHD beamline (ESRF/BM16) and</span>
<span class="sd">             requires a SPEC file and log file</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    logobj : numpy.ndarray or str</span>
<span class="sd">        2lD columns array (scanN, eneKeV) or RIXS log file name</span>
<span class="sd">    specobj : SpecfileData object</span>
<span class="sd">    fit_elastic : [False] controls if the elastic peak should be fitted</span>
<span class="sd">                  if True:</span>
<span class="sd">                      - fits the elastic peak with a SplitPseudoVoigt</span>
<span class="sd">                        function</span>
<span class="sd">                      - substract the fitted function from the data</span>
<span class="sd">                      - reset the energy array to the mono energy at the</span>
<span class="sd">                        center of FWHM</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xcol, ycol, zcol: 1D arrays</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">logobj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">logobj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">logobj</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
    <span class="n">scans</span> <span class="o">=</span> <span class="n">logobj</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># list of scan numers</span>
    <span class="n">enes</span> <span class="o">=</span> <span class="n">logobj</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span>  <span class="c1"># in eV</span>
    <span class="n">_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">scan</span><span class="p">,</span> <span class="n">ene</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scans</span><span class="p">,</span> <span class="n">enes</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">mot</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">specobj</span><span class="o">.</span><span class="n">get_scan</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">scan</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">mot</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">specobj</span><span class="o">.</span><span class="n">get_scan</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">scan</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INFO: loaded scan </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">scan</span><span class="p">)))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_mot2array</span><span class="p">(</span><span class="n">ene</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="c1"># perform some data treatment -&gt; TODO: move elsewhere!!!</span>
        <span class="k">if</span> <span class="n">fit_elastic</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">fit</span><span class="p">,</span> <span class="n">pw</span> <span class="o">=</span> <span class="n">fit_splitpvoigt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">bkg</span><span class="o">=</span><span class="s1">&#39;No Background&#39;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">fit</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">ene</span>
            <span class="c1"># z = fit.residual</span>
        <span class="k">if</span> <span class="n">_counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">xcol</span> <span class="o">=</span> <span class="n">x</span>
            <span class="n">ycol</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">zcol</span> <span class="o">=</span> <span class="n">z</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xcol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">ycol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ycol</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">zcol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zcol</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">_counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">xcol</span><span class="p">,</span> <span class="n">ycol</span><span class="p">,</span> <span class="n">zcol</span></div>


<div class="viewcode-block" id="DataGroupRixs"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.DataGroupRixs">[docs]</a><span class="k">class</span> <span class="nc">DataGroupRixs</span><span class="p">(</span><span class="n">DataGroup2D</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;DataGroup for RIXS planes&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwsd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">_larch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DataGroupRixs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwsd</span><span class="o">=</span><span class="n">kwsd</span><span class="p">,</span> <span class="n">_larch</span><span class="o">=</span><span class="n">_larch</span><span class="p">)</span>

<div class="viewcode-block" id="DataGroupRixs.getspecmap"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.DataGroupRixs.getspecmap">[docs]</a>    <span class="k">def</span> <span class="nf">getspecmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">scanlab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; 2D map from a list of scans read from SPEC data files&quot;&quot;&quot;</span>
        <span class="n">cntx</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cntx&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;cntx&#39;</span><span class="p">])</span>
        <span class="n">cnty</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cnty&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;cnty&#39;</span><span class="p">])</span>
        <span class="n">csig</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csig&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;csig&#39;</span><span class="p">])</span>
        <span class="n">cmon</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmon&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;cmon&#39;</span><span class="p">])</span>
        <span class="n">csec</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csec&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;csec&#39;</span><span class="p">])</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">])</span>
        <span class="n">xystep</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xystep&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;xystep&#39;</span><span class="p">])</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">spec_getmap2group</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">scans</span><span class="o">=</span><span class="n">scans</span><span class="p">,</span>
                              <span class="n">cntx</span><span class="o">=</span><span class="n">cntx</span><span class="p">,</span>
                              <span class="n">cnty</span><span class="o">=</span><span class="n">cnty</span><span class="p">,</span>
                              <span class="n">csig</span><span class="o">=</span><span class="n">csig</span><span class="p">,</span>
                              <span class="n">cmon</span><span class="o">=</span><span class="n">cmon</span><span class="p">,</span>
                              <span class="n">csec</span><span class="o">=</span><span class="n">csec</span><span class="p">,</span>
                              <span class="n">xystep</span><span class="o">=</span><span class="n">xystep</span><span class="p">,</span>
                              <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                              <span class="n">_larch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_larch</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">scanlab</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span></div>

<div class="viewcode-block" id="DataGroupRixs.plotmap"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.DataGroupRixs.plotmap">[docs]</a>    <span class="k">def</span> <span class="nf">plotmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imap</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plot for 2D map (e.g. RIXS plane)</span>

<span class="sd">        imap : index in gs list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">RixsDataPlotter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gs</span><span class="p">[</span><span class="n">imap</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="k">return</span></div></div>


<div class="viewcode-block" id="RixsData"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData">[docs]</a><span class="k">class</span> <span class="nc">RixsData</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;RIXS plane object&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwsd</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;initialize with keyword arguments dictionaries&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">kwsd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwsd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kwsd</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span> <span class="o">=</span> <span class="n">kwsd</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;rd</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

<div class="viewcode-block" id="RixsData.get_kwsd"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData.get_kwsd">[docs]</a>    <span class="k">def</span> <span class="nf">get_kwsd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;return a dictionary of dictionaries with keywords arguments:</span>

<span class="sd">        kwsd[&#39;exp&#39;][&#39;expdir&#39;] : main working directory (experiment directory)</span>
<span class="sd">        ...........[&#39;datdir&#39;] : directory where the raw data (e.g. SPEC data) are stored</span>
<span class="sd">        ...........[&#39;evaldir&#39;] : directory where evaluated data are saved</span>
<span class="sd">        ...........[&#39;mater&#39;] : material</span>
<span class="sd">        ...........[&#39;sample&#39;] : sample name</span>
<span class="sd">        ...........[&#39;explab&#39;] : label to identify the experiment</span>
<span class="sd">        ...........[&#39;geom&#39;] : data collection geometry (VGI or V## / HGI or H##)</span>
<span class="sd">        ...........[&#39;scnt&#39;] : type of scan (EXA, XAN, PRE, RIXS, RIXS_ET)</span>
<span class="sd">        ...........[&#39;mode&#39;] : data collection mode ???</span>

<span class="sd">        kwsd[&#39;spec&#39;][&#39;fname&#39;] : file name to load (full path)</span>
<span class="sd">        ............[&#39;rngstr&#39;] : string to identify the range of loaded scans</span>
<span class="sd">        ............[&#39;cntx&#39;] : name of x-axis counter/motor</span>
<span class="sd">        ............[&#39;cnty&#39;] : name of y-axis counter/motor</span>
<span class="sd">        ............[&#39;csig&#39;] : name for signal</span>
<span class="sd">        ............[&#39;cmon&#39;] : name for monitor (e.g. incoming beam monitor, I0)</span>
<span class="sd">        ............[&#39;cmon2&#39;] : name for a second monitor (e.g. total fluo yield, IF2)</span>
<span class="sd">        ............[&#39;csec&#39;] : name for seconds</span>
<span class="sd">        ............[&#39;norm&#39;] : normalization type (</span>
<span class="sd">        ............[&#39;xystep&#39;] : step in meshgrid</span>

<span class="sd">        kwsd[&#39;plot&#39;][&#39;...&#39;]</span>
<span class="sd">        ............</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwsd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;exp&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;expdir&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;datdir&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;evaldir&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;mater&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;sample&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;explab&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;geom&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;scnt&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                         <span class="s1">&#39;mode&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                <span class="s1">&#39;spec&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fname&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;rngstr&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;cntx&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="s1">&#39;cnty&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;csig&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;cmon&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;cmon2&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;csec&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;norm&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;xystep&#39;</span> <span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
                <span class="s1">&#39;grid&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xystep&#39;</span> <span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
                          <span class="s1">&#39;method&#39;</span> <span class="p">:</span> <span class="s1">&#39;cubic&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;lib&#39;</span>    <span class="p">:</span> <span class="s1">&#39;scipy&#39;</span><span class="p">},</span>
                <span class="s1">&#39;plot&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;replace&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="s1">&#39;figname&#39;</span> <span class="p">:</span> <span class="s1">&#39;RixsPlotter&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;figsize&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                          <span class="s1">&#39;figdpi&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                          <span class="s1">&#39;title&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;xlabel&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;ylabel&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;x_nticks&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="s1">&#39;y_nticks&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="s1">&#39;z_nticks&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="s1">&#39;xlabelE&#39;</span> <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Incoming Energy (eV)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;ylabelE&#39;</span> <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Emitted Energy (eV)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;ylabelEt&#39;</span> <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Energy transfer (eV)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;zlabel&#39;</span> <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Intensity (a.u)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;xystep&#39;</span> <span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
                          <span class="s1">&#39;xmin&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;xmax&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;ymin&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;ymax&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;xshift&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="s1">&#39;ystack&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="s1">&#39;xscale&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="s1">&#39;yscale&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="s1">&#39;cbar_show&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="s1">&#39;cbar_pos&#39;</span><span class="p">:</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;cbar_nticks&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                          <span class="s1">&#39;cbar_label&#39;</span> <span class="p">:</span> <span class="s1">&#39;Counts/s&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;cbar_norm0&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">gist_heat_r</span><span class="p">,</span>
                          <span class="s1">&#39;cmap2&#39;</span> <span class="p">:</span> <span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="p">,</span>
                          <span class="s1">&#39;cmap_linlog&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;cont_imshow&#39;</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="s1">&#39;cont_type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;cont_lwidths&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
                          <span class="s1">&#39;cont_levels&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                          <span class="s1">&#39;cont_labels&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;cont_labelformat&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;origin&#39;</span><span class="p">:</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;lcuts&#39;</span> <span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="s1">&#39;xcut&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;ycut&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;dcut&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="s1">&#39;lc_dticks&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                          <span class="s1">&#39;lc_color&#39;</span> <span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;lc_lw&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}}</span>
        <span class="k">return</span> <span class="n">kwsd</span></div>

<div class="viewcode-block" id="RixsData.loadxyz"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData.loadxyz">[docs]</a>    <span class="k">def</span> <span class="nf">loadxyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;load data from a 3 columns ASCII file assuming the format: e_in,</span>
<span class="sd">        e_out, signal</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loaded </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error in loading </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#decide if dat[:,1] is e_out or e_in-e_out</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ycol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">etcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ycol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">etcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># energy transfer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dat</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="RixsData.gridxyz"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData.gridxyz">[docs]</a>    <span class="k">def</span> <span class="nf">gridxyz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;create gridded standard groups&quot;&quot;&quot;</span>
        <span class="n">xystep</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xystep&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;xystep&#39;</span><span class="p">])</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;method&#39;</span><span class="p">])</span>
        <span class="n">lib</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lib&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;lib&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zz</span> <span class="o">=</span> <span class="n">gridxyz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">ycol</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">zcol</span><span class="p">,</span>
                                          <span class="n">xystep</span><span class="o">=</span><span class="n">xystep</span><span class="p">,</span>
                                          <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                                          <span class="n">lib</span><span class="o">=</span><span class="n">lib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">et</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ezz</span> <span class="o">=</span> <span class="n">gridxyz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">etcol</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">zcol</span><span class="p">,</span>
                                             <span class="n">xystep</span><span class="o">=</span><span class="n">xystep</span><span class="p">,</span>
                                             <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                                             <span class="n">lib</span><span class="o">=</span><span class="n">lib</span><span class="p">)</span></div>

<div class="viewcode-block" id="RixsData.load_spec_map"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData.load_spec_map">[docs]</a>    <span class="k">def</span> <span class="nf">load_spec_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;load the plane from SPEC file</span>

<span class="sd">        TODO: merge this in the previous load_xyz and the SPEC part in</span>
<span class="sd">        specfile</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">datdir</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;datdir&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;datdir&#39;</span><span class="p">])</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fname&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;fname&#39;</span><span class="p">])</span>
        <span class="n">scans</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scans&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;rngstr&#39;</span><span class="p">])</span>
        <span class="n">scnt</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;scnt&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">][</span><span class="s1">&#39;scnt&#39;</span><span class="p">])</span>
        <span class="n">cntx</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cntx&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;cntx&#39;</span><span class="p">])</span>
        <span class="n">cnty</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cnty&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;cnty&#39;</span><span class="p">])</span>
        <span class="n">csig</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csig&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;csig&#39;</span><span class="p">])</span>
        <span class="n">cmon</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmon&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;cmon&#39;</span><span class="p">])</span>
        <span class="n">csec</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csec&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;csec&#39;</span><span class="p">])</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">][</span><span class="s1">&#39;norm&#39;</span><span class="p">])</span>
        <span class="n">xystep</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xystep&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;xystep&#39;</span><span class="p">])</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;method&#39;</span><span class="p">])</span>
        <span class="n">lib</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lib&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;lib&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sfd</span> <span class="o">=</span> <span class="n">SpecfileData</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">datdir</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>
        <span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfd</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="n">scans</span><span class="o">=</span><span class="n">scans</span><span class="p">,</span>
                                             <span class="n">cntx</span><span class="o">=</span><span class="n">cntx</span><span class="p">,</span>
                                             <span class="n">cnty</span><span class="o">=</span><span class="n">cnty</span><span class="p">,</span>
                                             <span class="n">csig</span><span class="o">=</span><span class="n">csig</span><span class="p">,</span>
                                             <span class="n">cmon</span><span class="o">=</span><span class="n">cmon</span><span class="p">,</span>
                                             <span class="n">csec</span><span class="o">=</span><span class="n">csec</span><span class="p">,</span>
                                             <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        <span class="c1"># in case of rixs_et we swap x&lt;-&gt;y</span>
        <span class="k">if</span> <span class="s1">&#39;rixs_et&#39;</span> <span class="ow">in</span> <span class="n">scnt</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ycol</span> <span class="o">=</span> <span class="n">_y</span><span class="p">,</span> <span class="n">_x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ycol</span> <span class="o">=</span> <span class="n">_x</span><span class="p">,</span> <span class="n">_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">etcol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ycol</span> <span class="c1"># energy transfer</span></div>

<div class="viewcode-block" id="RixsData.crop"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData.crop">[docs]</a>    <span class="k">def</span> <span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">yet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;crop the plane in a given range</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        x1, y1, x2, y2 : floats</span>
<span class="sd">                         X/Y initial and new coordinates</span>

<span class="sd">        yet : boolean, False</span>
<span class="sd">              defines if the Y coordinates are given in emission or</span>
<span class="sd">              energy transfer</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_xystep</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xystep&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;xystep&#39;</span><span class="p">])</span>
        <span class="n">_method</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;grid&#39;</span><span class="p">][</span><span class="s1">&#39;method&#39;</span><span class="p">])</span>

        <span class="n">_nxpts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">_xystep</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xcrop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">_nxpts</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">yet</span><span class="p">:</span>
            <span class="n">_netpts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="n">_xystep</span><span class="p">)</span>
            <span class="n">_ymin</span> <span class="o">=</span> <span class="n">x2</span><span class="o">-</span><span class="n">y2</span>
            <span class="n">_ymax</span> <span class="o">=</span> <span class="n">x1</span><span class="o">-</span><span class="n">y1</span>
            <span class="n">_nypts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">_ymax</span><span class="o">-</span><span class="n">_ymin</span><span class="p">)</span><span class="o">/</span><span class="n">_xystep</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">etcrop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">_netpts</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ycrop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">_ymin</span><span class="p">,</span> <span class="n">_ymax</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">_nypts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_nypts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="n">_xystep</span><span class="p">)</span>
            <span class="n">_etmin</span> <span class="o">=</span> <span class="n">x1</span><span class="o">-</span><span class="n">y2</span>
            <span class="n">_etmax</span> <span class="o">=</span> <span class="n">x2</span><span class="o">-</span><span class="n">y1</span>
            <span class="n">_netpts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">_etmax</span><span class="o">-</span><span class="n">_etmin</span><span class="p">)</span><span class="o">/</span><span class="n">_xystep</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">etcrop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">_etmin</span><span class="p">,</span> <span class="n">_etmax</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">_netpts</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ycrop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">_nypts</span><span class="p">)</span>

        <span class="n">_xx</span><span class="p">,</span> <span class="n">_yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcrop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ycrop</span><span class="p">)</span>
        <span class="n">_exx</span><span class="p">,</span> <span class="n">_et</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xcrop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etcrop</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">zzcrop</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ycol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcol</span><span class="p">,</span> <span class="p">(</span><span class="n">_xx</span><span class="p">,</span> <span class="n">_yy</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="n">_method</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ezzcrop</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">xcol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">etcol</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcol</span><span class="p">,</span> <span class="p">(</span><span class="n">_exx</span><span class="p">,</span> <span class="n">_et</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="n">_method</span><span class="p">)</span>

        <span class="k">return</span></div>

<div class="viewcode-block" id="RixsData.norm"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsData.norm">[docs]</a>    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;normalization to max-min&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">zz</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">zz</span><span class="p">))</span></div></div>

<div class="viewcode-block" id="RixsDataPlotter"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsDataPlotter">[docs]</a><span class="k">class</span> <span class="nc">RixsDataPlotter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; plotter for a RixsData object &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rd</span><span class="p">):</span>
        <span class="s2">&quot;initialize with keyword arguments dictionaries&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;RixsData&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rd</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;I can only plot &quot;RixsData&quot; objects!&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">kwsd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">rd</span>

<div class="viewcode-block" id="RixsDataPlotter.updatekwsd"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsDataPlotter.updatekwsd">[docs]</a>    <span class="k">def</span> <span class="nf">updatekwsd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwsd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; update plot parameters &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwsd</span><span class="p">)</span></div>

<div class="viewcode-block" id="RixsDataPlotter.plot"><a class="viewcode-back" href="../../../modules/collects.html#sloth.collects.datagroup_rixs.RixsDataPlotter.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; make the plot &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">ex</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">x</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">et</span>
            <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="n">zz</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">zz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">ezz</span>
            <span class="n">zz0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">zz</span>

        <span class="c1"># check if x and y are 1D or 2D arrays</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">):</span>
            <span class="n">_xyshape</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">):</span>
            <span class="n">_xyshape</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="n">lcuts</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lcuts&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;lcuts&#39;</span><span class="p">])</span>
        <span class="n">xcut</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xcut&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;xcut&#39;</span><span class="p">])</span>
        <span class="n">ycut</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ycut&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;ycut&#39;</span><span class="p">])</span>
        <span class="n">dcut</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dcut&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;dcut&#39;</span><span class="p">])</span>

        <span class="n">lc_dticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lc_dticks&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;lc_dticks&#39;</span><span class="p">])</span>
        <span class="n">lc_color</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lc_color&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;lc_color&#39;</span><span class="p">])</span>
        <span class="n">lc_lw</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lc_lw&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;lc_lw&#39;</span><span class="p">])</span>

        <span class="n">replace</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;replace&#39;</span><span class="p">])</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figname&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;figname&#39;</span><span class="p">])</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figsize&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;figsize&#39;</span><span class="p">])</span>
        <span class="n">figdpi</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;figdpi&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;figdpi&#39;</span><span class="p">])</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlabel&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;xlabelE&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">):</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;ylabelEt&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylabel&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;ylabelE&#39;</span><span class="p">])</span>
        <span class="n">zlabel</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zlabel&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;zlabel&#39;</span><span class="p">])</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmin&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;xmin&#39;</span><span class="p">])</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xmax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;xmax&#39;</span><span class="p">])</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ymin&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;ymin&#39;</span><span class="p">])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ymax&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;ymax&#39;</span><span class="p">])</span>
        <span class="n">x_nticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x_nticks&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;x_nticks&#39;</span><span class="p">])</span>
        <span class="n">y_nticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;y_nticks&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;y_nticks&#39;</span><span class="p">])</span>
        <span class="n">z_nticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;z_nticks&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;z_nticks&#39;</span><span class="p">])</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cmap&#39;</span><span class="p">])</span>

        <span class="n">cbar_show</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar_show&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cbar_show&#39;</span><span class="p">])</span>
        <span class="n">cbar_pos</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar_pos&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cbar_pos&#39;</span><span class="p">])</span>
        <span class="n">cbar_nticks</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar_nticks&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cbar_nticks&#39;</span><span class="p">])</span>
        <span class="n">cbar_label</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar_label&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cbar_label&#39;</span><span class="p">])</span>
        <span class="n">cbar_norm0</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cbar_norm0&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cbar_norm0&#39;</span><span class="p">])</span>

        <span class="n">cont_imshow</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cont_imshow&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cont_imshow&#39;</span><span class="p">])</span>
        <span class="n">cont_type</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cont_type&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cont_type&#39;</span><span class="p">])</span>
        <span class="n">cont_levels</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cont_levels&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cont_levels&#39;</span><span class="p">])</span>
        <span class="n">cont_lwidths</span> <span class="o">=</span> <span class="n">kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cont_lwidths&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwsd</span><span class="p">[</span><span class="s1">&#39;plot&#39;</span><span class="p">][</span><span class="s1">&#39;cont_lwidths&#39;</span><span class="p">])</span>

        <span class="c1"># NOTE: np.nanmin/np.nanmax fails with masked arrays! better</span>
        <span class="c1">#       to work with MaskedArray for zz</span>

        <span class="c1">#if not &#39;MaskedArray&#39; in str(type(zz)):</span>
        <span class="c1">#    zz = np.ma.masked_where(zz == np.nan, zz)</span>

        <span class="c1"># NOTE2: even with masked arrays min()/max() fail!!!  I do a</span>
        <span class="c1">#        manual check against &#39;nan&#39; instead of the masked</span>
        <span class="c1">#        array solution</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">zzmin</span><span class="p">,</span> <span class="n">zzmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">zz</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">zzmin</span><span class="p">,</span> <span class="n">zzmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zz</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cbar_norm0</span><span class="p">:</span>
            <span class="c1"># normalize colors around 0</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zzmin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zzmax</span><span class="p">):</span>
                <span class="n">vnorm</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zzmin</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vnorm</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zzmax</span><span class="p">)</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="n">vnorm</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vnorm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># normalize colors from min to max</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">zzmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">zzmax</span><span class="p">)</span>

        <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">zzmin</span><span class="p">,</span> <span class="n">zzmax</span><span class="p">,</span> <span class="n">cont_levels</span><span class="p">)</span>

        <span class="c1">### FIGURE LAYOUT ###</span>
        <span class="k">if</span> <span class="n">replace</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">figname</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">figdpi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">replace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># 1 DATA SET WITH OR WITHOUT LINE CUTS</span>
        <span class="k">if</span> <span class="n">lcuts</span><span class="p">:</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1">#3x3 grid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># plane</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># cut along x-axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># cut along d-axis (diagonal)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># cut along y-axis</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span> <span class="c1">#plot olny plane</span>

        <span class="c1"># plane</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xmin</span> <span class="ow">and</span> <span class="n">xmax</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ymin</span> <span class="ow">and</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

        <span class="c1"># contour mode: &#39;contf&#39; or &#39;imshow&#39;</span>
        <span class="k">if</span> <span class="n">cont_imshow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">zz</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;line&#39;</span> <span class="ow">in</span> <span class="n">cont_type</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cont</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">cont_lwidths</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x_nticks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x_nticks</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">y_nticks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y_nticks</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plane</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>

        <span class="c1"># colorbar</span>
        <span class="k">if</span> <span class="n">cbar_show</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contf</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">cbar_pos</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cbar_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y_nticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">)</span>

        <span class="c1"># xcut plot</span>
        <span class="k">if</span> <span class="n">lcuts</span> <span class="ow">and</span> <span class="n">xcut</span><span class="p">:</span>
            <span class="n">xpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xcut</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">_xyshape</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">zz</span><span class="p">[:,</span><span class="n">xpos</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">xpos</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">lc_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lc_lw</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">_xyshape</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span><span class="n">xpos</span><span class="p">],</span> <span class="n">zz</span><span class="p">[:,</span><span class="n">xpos</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">xpos</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">lc_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lc_lw</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">y_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y_nticks</span><span class="o">/</span><span class="n">lc_dticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">z_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z_nticks</span><span class="o">/</span><span class="n">lc_dticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">zlabel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="ow">and</span> <span class="n">ymax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lxcut</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

        <span class="c1"># ycut plot</span>
        <span class="k">if</span> <span class="n">lcuts</span> <span class="ow">and</span> <span class="n">ycut</span><span class="p">:</span>
            <span class="n">ypos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ycut</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">_xyshape</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">zz</span><span class="p">[</span><span class="n">ypos</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">ypos</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">lc_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lc_lw</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">_xyshape</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ypos</span><span class="p">,:],</span> <span class="n">zz</span><span class="p">[</span><span class="n">ypos</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">ypos</span><span class="p">,:][</span><span class="mi">0</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">lc_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lc_lw</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x_nticks</span><span class="o">/</span><span class="n">lc_dticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">z_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z_nticks</span><span class="o">/</span><span class="n">lc_dticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">zlabel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xmin</span> <span class="ow">and</span> <span class="n">xmax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lycut</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>

        <span class="c1"># dcut plot =&gt; equivalent to ycut plot for (zz0, x0, y0)</span>
        <span class="k">if</span> <span class="n">lcuts</span> <span class="ow">and</span> <span class="n">dcut</span><span class="p">:</span>
            <span class="n">ypos0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dcut</span><span class="o">-</span><span class="n">y0</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">_xyshape</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">zz0</span><span class="p">[</span><span class="n">ypos0</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="n">ypos0</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">lc_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lc_lw</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">_xyshape</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x0</span><span class="p">[</span><span class="n">ypos0</span><span class="p">,:],</span> <span class="n">zz0</span><span class="p">[</span><span class="n">ypos0</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="n">ypos0</span><span class="p">,:][</span><span class="mi">0</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">lc_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lc_lw</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x_nticks</span><span class="o">/</span><span class="n">lc_dticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">z_nticks</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">z_nticks</span><span class="o">/</span><span class="n">lc_dticks</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">AutoLocator</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">zlabel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xmin</span> <span class="ow">and</span> <span class="n">xmax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ldcut</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014--2019, Mauro Rovezzi

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>